import nmap
from pymetasploit3.msfrpc import *
import time
import numpy
#from nmap_scanner import *

# initialize the port scanner
target_info = []
os = ['linux', 'windows', 'unix']

'''
target_info's index information:
0 = port
1 = state
2 = name
3 = product
4 = version
5 = additional info
6 = common platform enumeration
7 = ip
'''

exploits = []                                                       

		
def search_exploits(obj):
	rows = len(target_info)
	for i in obj:
		for j in range(rows):
			if target_info[j][3] in i:
				if target_info[j][3] in i:
					exploits.append(i) #TODO : implement OS exploitation detection
	
def get_target_info():
	fp = open("targets.txt", "r")
	lines = fp.readlines()
	for line in lines:
	    word = line.split(' , ')
	    global target_info
	    target_info.append(word)
		
if __name__ == '__main__':
	client = MsfRpcClient(password='password', ip='127.0.0.1')
	obj = client.modules.exploits
	get_target_info()
	print(target_info)

	search_exploits(obj)
	if not exploits:
		print('No exploits found!')
	print('Here is the list of exploits that can be used:')
	print(exploits)

	
