#Team Zephyr
import nmap 
import argparse

def nmap_scan(tgt_host, tgt_ports):
    nm_scan = nmap.PortScanner()
    for tgt_port in tgt_ports:
        nm_scan.scan(tgt_host, tgt_port)
        state = nm_scan[tgt_host]['tcp'][int(tgt_port)]['state']
        print(f'[*] {tgt_host} tcp/{tgt_port} {state}')

if __name__ == '__main__':
    parser = argparse.ArgumentParser(
        usage='nmap_scanner.py TARGET_HOST -p TARGET_PORTS'
              '\nexample: python3 nmap_scanner.py scanme.nmap.org -p 21,80')

    parser.add_argument('host', type=str, metavar='TARGET_HOST',
                        help='specify target host (IP address or domain name)')
    parser.add_argument('-p', required=True, type=str, metavar='TARGET_PORTS',
                        help='specify target port[s] separated by comma '
                             '(no spaces)')
    args = parser.parse_args()

    args.tgt_ports = str(args.p).split(',')
    print(args.tgt_ports)
    print(args.host)
    nmap_scan(args.host, args.tgt_ports)

